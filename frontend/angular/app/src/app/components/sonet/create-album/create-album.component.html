<div class="flex align-items-start text-white">
    <div>
        <i class="fas fa-music mr-2 mt-1"></i>
    </div>
    <h3 class="mt-0">CREATE ALBUM</h3>
</div>
<div class="alb-top card mb-2 flex align-items-center ml-5">
    <div class="btn mr-4">
        <p-button [disabled]="currentStep == 0" icon="pi pi-chevron-left" label="Prev" (click)="goToPreviousStep()"></p-button>
    </div>
    <div class="col-10">
        <p-steps [model]="createStepItems" [readonly]="false" [activeIndex]="currentStep" [styleClass]="'completed-'+visitedSteps"></p-steps>
    </div>
    <div class="btn">
        <p-button [disabled]="currentStep == 2" icon="pi pi-chevron-right" label="Next" (click)="goToNextStep()"></p-button>
    </div>
</div>

<!-- DETAILS -->
<div *ngIf="currentStep == 0">
    <p-fieldset legend="Details" class="field-container">
        <form #detailsForm="ngForm">
            <div class="flex flex-wrap">
                <div class="field col-6">
                    <label>Title*</label>
                    <input pInputText #title="ngModel" type="text" [(ngModel)]="album.title" required="required" name="title" placeholder="Album title" class="w-full"/>
                    <div *ngIf="title.invalid && (title.dirty || title.touched)" class="p-error">
                        <small *ngIf="title.errors['required']">Title is required.</small>
                    </div>
                </div>

                <div class="field col-6">
                    <div class="flex">
                        <div>
                            <label class="mb-6">Album Cover Image</label>
                            <div class="flex align-items-center">
                                <div class="btn btn-clear mr-2">
                                    <button *ngIf="album.selectedImageURL || album.coverImageURL" pButton type="button" icon="pi pi-times" (click)="onClearImageClick(albumCoverUpload, album, 'selectedImageURL')"></button>
                                </div>
                                <p-fileUpload #albumCoverUpload mode="basic" name="albumCoverImage" [url]="album.coverImageFile" accept="image/*" [showCancelButton]="true" [maxFileSize]="1000000" (onSelect)="onAlbumCoverSelect($event)" chooseLabel="Select Album Cover"></p-fileUpload>
                            </div>
                        </div>
                        <div *ngIf="album.selectedImageURL || album.coverImageURL" class="flex mt-2 ml-4">
                            <p-image [src]="album.selectedImageURL || album.coverImageURL" alt="Cover Image" width="100" [preview]="true" [imageStyle]="{'border-radius': '18px', 'border': '2px solid #85c4c1'}" appendTo="body"></p-image>
                        </div>
                    </div>
                </div>

                <div class="field col-6">
                    <label>Description</label>
                    <textarea rows="5" cols="30" pInputTextarea [(ngModel)]="album.description" name="description" placeholder="Description..." class="w-full"></textarea>
                </div>

                <div class="field col-6">
                    <label>Release Date*</label>
                    <p-calendar name="releaseDate" #releaseDate="ngModel" dataType="string" [(ngModel)]="album.releaseDate" dateFormat="dd-mm-yy" placeholder="dd-mm-yyyy" [maxDate]="todayDate" [defaultDate]="todayDate" appendTo="body" [required]="true" [showIcon]="true"></p-calendar>
                    <div *ngIf="releaseDate.invalid && (releaseDate.dirty || releaseDate.touched)" class="p-error">
                        <small *ngIf="releaseDate.errors['required']">Release Date is required.</small>
                    </div>
                </div>
            </div>
        </form>
    </p-fieldset>
</div>

<!-- ADD SONGS -->
<div *ngIf="currentStep == 1">
    <p-accordion class="w-full">
        <p-accordionTab *ngFor="let song of songs">
            <ng-template pTemplate="header">
                <span class="flex align-items-center gap-2 w-full">
                    <p-avatar image="assets/images/sing-img.webp" shape="circle" />
                    <span class="font-bold white-space-nowrap">{{ song.name }}</span>
                </span>
            </ng-template>
            <p-fieldset legend="Song Details" class="field-container">
                <form #songDetailsForm="ngForm">
                    <div class="flex flex-wrap">
                        <div class="field">
                            <label>Name*</label>
                            <input pInputText #name="ngModel" type="text" [(ngModel)]="song.name" required="required" name="name" placeholder="Song name" class="w-full"/>
                            <div *ngIf="name.invalid && (name.dirty || name.touched)" class="p-error">
                                <small *ngIf="name.errors['required']">Name is required.</small>
                            </div>
                        </div>
                        <div class="field">
                            <label>Primary Image*</label>
                            <p-fileUpload mode="basic" name="primaryImage" accept="image/*" [maxFileSize]="1000000" (onSelect)="onSongImageSelect($event)" chooseLabel="Select Song"></p-fileUpload>
                        </div>
                    </div>
                </form>
            </p-fieldset>
        </p-accordionTab>
    </p-accordion>
</div>

<!-- PUBLISH -->
<div *ngIf="currentStep == 2">

</div>
<p-progressSpinner *ngIf="showLoader"></p-progressSpinner>